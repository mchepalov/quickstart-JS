<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Быстрый старт JS</title>
  </head>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    body h1 {
      margin: 15px 0;
    }

    my-select {
      margin: 10px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      width: 75%;
      text-align: center;
    }

    my-select button,
    my-select input,
    my-select label,
    my-select h3 {
      margin: 10px 5px;
    }
  </style>
  <body>
    <h1>Веб-компоненты</h1>

    <my-select>
      <option value="opt1">Option 1</option>
      <option value="opt2">Option 2</option>
      <option value="opt3">Option 3</option>
    </my-select>

    <script>
      const onLoad = (evt) => {
        const componentName = evt.target.dataset.name;
        console.log('Скрипт загружен:', evt.target.src);
        console.log('Имя компонента:', componentName);
        console.log('MySelect доступен:', !!window.MySelect);

        if (window.MySelect) {
          customElements.define(componentName, window.MySelect);
          console.log('Компонент зарегистрирован:', componentName);
        }
      };

      const onError = (err) => {
        console.error('Ошибка загрузки:', err);
      };

      const components = ['my-select'];

      setTimeout(() => {
        console.log('Начинаем загрузку веб-компонента через 1 секунду');
        
        components.forEach((component) => {
          const script = document.createElement('script');
          script.src = `./${component}.js`;
          script.dataset.name = component;
          script.addEventListener('load', onLoad);
          script.addEventListener('error', onError);
          document.body.append(script);
        });
      }, 1000);
    </script>
  </body>
</html>
